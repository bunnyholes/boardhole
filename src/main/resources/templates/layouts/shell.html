<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head th:fragment="head(pageTitle)">
    <th:block th:replace="~{fragments/head :: head(pageTitle)}"/>
</head>
<body>
<th:block th:fragment="shell(pageTitle, bodyFragment)">
    <th:block th:replace="~{fragments/sidebar :: sidebar()}"/>
    <div class="ml-20 flex min-h-screen flex-col">
        <th:block th:replace="~{fragments/header :: header()}"/>
        <th:block th:replace="${bodyFragment}"/>
    </div>

    <div id="searchPopover" popover
         class="mx-auto mt-24 w-full max-w-xl rounded-3xl bg-white p-8 shadow-2xl
                transition-discrete
                starting:open:opacity-0
                starting:open:scale-95
                starting:open:-translate-y-2
                open:opacity-100
                open:scale-100
                open:translate-y-0
                transition-opacity
                transition-transform
                duration-250
                ease-out
                [&::backdrop]:bg-slate-900/50
                [&::backdrop]:backdrop-blur
                [&::backdrop]:transition-discrete
                [&::backdrop]:starting:open:opacity-0
                [&::backdrop]:open:opacity-100
                [&::backdrop]:transition-opacity
                [&::backdrop]:duration-250">
        <button popovertarget="searchPopover" popovertargetaction="hide"
                class="absolute right-5 top-5 flex h-9 w-9 items-center justify-center rounded-full text-slate-500 transition hover:bg-slate-100 hover:text-slate-900"
                aria-label="검색 닫기">
            <svg aria-hidden="true" viewBox="0 0 24 24" class="h-4 w-4" fill="none"
                 stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round">
                <line x1="7" y1="7" x2="17" y2="17"/>
                <line x1="17" y1="7" x2="7" y2="17"/>
            </svg>
        </button>
        <h3 class="text-2xl font-semibold text-slate-900">검색</h3>
        <p class="mt-2 text-sm text-slate-500">키워드를 입력하고 바로 필요한 보드를 찾아보세요.</p>
        <form action="/boards" class="mt-6">
            <div class="flex items-center gap-3 rounded-2xl border border-slate-200 bg-white p-4 shadow-inner">
                <svg aria-hidden="true" viewBox="0 0 24 24" class="h-5 w-5 text-slate-400" fill="none" stroke="currentColor"
                     stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="11" cy="11" r="6"/>
                    <line x1="16.5" y1="16.5" x2="20" y2="20"/>
                </svg>
                <div class="tip-wrapper relative flex-1 group/popover-search">
                    <input type="search"
                           name="search"
                           aria-describedby="layout-popover-search-tip"
                           class="tip-anchor w-full bg-transparent text-sm text-slate-700 outline-none placeholder:text-slate-400 [anchor-name:--popover-search]"
                           placeholder="검색어 입력" autofocus/>
                    <div id="layout-popover-search-tip" role="tooltip"
                         class="tip-tooltip pointer-events-none absolute z-10 overflow-hidden rounded-xl bg-slate-900/90 px-3 py-2 text-xs font-medium text-white opacity-0 invisible delay-150 [transition-property:opacity,visibility] duration-150 [transition-behavior:allow-discrete] [position-anchor:--popover-search] [bottom:calc(anchor(top)+12px)] [left:anchor(center)] [translate:-50%_0] whitespace-nowrap text-left leading-5 text-ellipsis [max-inline-size:clamp(12rem,30vw,16rem)] group-hover/popover-search:delay-0 group-hover/popover-search:opacity-100 group-hover/popover-search:visible group-focus-within/popover-search:delay-0 group-focus-within/popover-search:opacity-100 group-focus-within/popover-search:visible">
                        검색어 입력후 엔터를 입력하세요.
                    </div>
                </div>
            </div>
        </form>
    </div>

    <div id="logoutPopover" popover
         class="mx-auto mt-24 w-full max-w-md rounded-3xl bg-white p-8 shadow-2xl
                transition-discrete
                starting:open:opacity-0
                starting:open:scale-95
                starting:open:-translate-y-2
                open:opacity-100
                open:scale-100
                open:translate-y-0
                transition-opacity
                transition-transform
                duration-250
                ease-out
                [&::backdrop]:bg-slate-900/50
                [&::backdrop]:backdrop-blur
                [&::backdrop]:transition-discrete
                [&::backdrop]:starting:open:opacity-0
                [&::backdrop]:open:opacity-100
                [&::backdrop]:transition-opacity
                [&::backdrop]:duration-250"
         th:if="${#authentication?.principal != null and #authentication?.principal != 'anonymousUser'}">
        <button popovertarget="logoutPopover" popovertargetaction="hide"
                class="absolute right-5 top-5 flex h-9 w-9 items-center justify-center rounded-full text-slate-500 transition hover:bg-slate-100 hover:text-slate-900"
                aria-label="로그아웃 닫기">
            <svg aria-hidden="true" viewBox="0 0 24 24" class="h-4 w-4" fill="none"
                 stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round">
                <line x1="7" y1="7" x2="17" y2="17"/>
                <line x1="17" y1="7" x2="7" y2="17"/>
            </svg>
        </button>
        <h3 class="text-2xl font-semibold text-slate-900">로그아웃 하시겠어요?</h3>
        <p class="mt-2 text-sm text-slate-500">현재 세션이 종료되고 다시 로그인해야 합니다.</p>
        <div class="mt-6 rounded-2xl bg-slate-50 p-4">
            <p class="text-xs text-slate-500">보안상의 이유로 공용 기기에서는 항상 로그아웃을 권장합니다.</p>
        </div>
        <div class="mt-6 flex items-center justify-end gap-3">
            <button type="button" popovertarget="logoutPopover" popovertargetaction="hide"
                    class="rounded-full border border-slate-200 px-5 py-2 text-sm font-medium text-slate-600 transition hover:border-slate-300">
                취소
            </button>
            <a th:href="@{/auth/logout}" href="/auth/logout"
               class="rounded-full bg-slate-900 px-5 py-2 text-sm font-semibold text-white transition hover:bg-slate-700">
                로그아웃
            </a>
        </div>
    </div>
</th:block>
</body>
</html>
