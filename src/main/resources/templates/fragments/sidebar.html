<th:block xmlns:th="http://www.thymeleaf.org" th:fragment="sidebar()">
    <style type="text/tailwindcss">
        @layer base {
            body {
                @apply sm:ml-20;
            }

            #main-header {
                @apply pl-20 sm:pl-0;
            }
        }
    </style>

    <aside id="sidebar"
           popover
           th:with="requestUri=${#httpServletRequest != null ? #httpServletRequest.requestURI : ''}"
           class="group fixed sm:left-0 sm:top-0 w-full sm:w-20 sm:open:w-80 h-screen transition-discrete starting:open:opacity-0 transition-opacity sm:[transition-property:width] duration-300 ease-out sm:flex flex-col bg-surface-100-900/70 backdrop-blur z-40">
        <div class="flex flex-col w-full h-full sm:w-80 overflow-x-hidden">
            <header class="flex w-full h-20">
                <button aria-label="BOARDHOLE 홈"
                        class="grid place-items-center-safe w-20 h-full"
                        popovertarget="sidebar"
                        popovertargetaction="toggle"
                        title="BOARDHOLE 홈">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                         class="lucide lucide-menu-icon lucide-menu">
                        <path d="M4 5h16"
                              class="transition-all duration-300 origin-[12px_5px] group-open:translate-y-[7px] group-open:rotate-45"/>
                        <path d="M4 12h16" class="transition-opacity duration-300 group-open:opacity-0"/>
                        <path d="M4 19h16"
                              class="transition-all duration-300 origin-[12px_19px] group-open:-translate-y-[7px] group-open:-rotate-45"/>
                    </svg>
                </button>
                <div class="flex-1 content-center-safe px-6">
                    <p class="uppercase tracking-[0.4em] text-sm text-slate-300">Menu</p>
                </div>
            </header>

            <nav class="flex-1 flex flex-col w-full overflow-y-auto text-surface-400-600">
                <a th:href="@{/users/me}" href="/users/me"
                   class="flex h-20 w-full hover:preset-filled-surface-400-600 transition"
                   th:classappend="${#strings.startsWith(requestUri, '/users/me')} ? ' preset-filled-surface-400-600 text-white' : ''"
                   aria-label="Profile" title="Profile"
                   th:attr="aria-current=${#strings.startsWith(requestUri, '/users/me')} ? 'page' : null">
                    <div class="w-20 grid place-items-center-safe">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                             class="lucide lucide-user-round">
                            <circle cx="12" cy="8" r="5"/>
                            <path d="M20 21a8 8 0 0 0-16 0"/>
                        </svg>
                    </div>
                    <span class="flex-1 content-center-safe px-6">프로필</span>
                </a>

                <a th:href="@{/boards}" href="/boards"
                   class="flex h-20 w-full hover:preset-filled-surface-400-600 transition"
                   th:classappend="${#strings.startsWith(requestUri, '/boards')} ? ' preset-filled-surface-400-600 text-white' : ''"
                   aria-label="Boards" title="Boards"
                   th:attr="aria-current=${#strings.startsWith(requestUri, '/boards')} ? 'page' : null">
                    <div class="w-20 grid place-items-center-safe">
                        <svg aria-hidden="true" viewBox="0 0 24 24" class="h-5 w-5" fill="none"
                             stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="4" y="3" width="14" height="18" rx="2"/>
                            <line x1="8" y1="3" x2="8" y2="21"/>
                            <line x1="11.5" y1="8" x2="16" y2="8"/>
                            <line x1="11.5" y1="12" x2="16" y2="12"/>
                        </svg>
                    </div>
                    <span class="flex-1 content-center-safe px-6">게시판</span>
                </a>

                <a th:if="${#authorization.expression('hasRole(''ADMIN'')')}"
                   th:href="@{/users}" href="/users"
                   class="flex h-20 w-full hover:preset-filled-surface-400-600 transition"
                   th:classappend="${#strings.startsWith(requestUri, '/users')} ? ' preset-filled-surface-400-600 text-white' : ''"
                   aria-label="Users" title="Users"
                   th:attr="aria-current=${#strings.startsWith(requestUri, '/users')} ? 'page' : null">
                    <div class="w-20 grid place-items-center-safe">
                        <svg aria-hidden="true" viewBox="0 0 24 24" class="h-5 w-5" fill="none"
                             stroke="currentColor" stroke-width="1.75" stroke-linecap="round"
                             stroke-linejoin="round">
                            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                            <circle cx="8.5" cy="7" r="4"/>
                            <path d="M20 8v6"/>
                            <path d="M23 11h-6"/>
                        </svg>
                    </div>
                    <span class="flex-1 content-center-safe px-6">사용자 관리</span>
                </a>
            </nav>

            <footer class="flex flex-col w-full text-surface-400-600">
                <a href="/boards"
                   class="flex h-20 w-full hover:preset-filled-surface-400-600 transition"
                   aria-label="알림" title="알림">
                    <div class="w-20 grid place-items-center-safe">
                        <svg aria-hidden="true" viewBox="0 0 24 24" class="h-5 w-5" fill="none"
                             stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M6.84 10.143a1.5 1.5 0 0 1-.44-1.062A5.603 5.603 0 0 1 6.82 7.57a5.601 5.601 0 0 1 1.65-2.725l.044-.04A5.275 5.275 0 0 1 12 3c1.402 0 2.6.543 3.486 1.398l.044.041a5.601 5.601 0 0 1 1.65 2.725 5.6 5.6 0 0 1 .42 2.572 1.5 1.5 0 0 1-.44 1.062M14.828 15.536a4 4 0 1 1-5.657 0"/>
                            <path d="M6.84 10.143c-1.487.361-2.464.884-3.064 1.587C3 13.326 3 14.662 3 18h18c0-3.338 0-4.674-.776-6.27-.6-.703-1.577-1.226-3.064-1.587"/>
                        </svg>
                    </div>
                    <span class="flex-1 content-center-safe px-6">알림</span>
                </a>
            </footer>
        </div>
    </aside>

    <button aria-label="BOARDHOLE 홈"
            class="fixed left-0 top-0 w-20 h-20 grid place-items-center-safe"
            popovertarget="sidebar"
            popovertargetaction="toggle"
            title="BOARDHOLE 홈">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="lucide lucide-menu-icon lucide-menu">
            <path d="M4 5h16"/>
            <path d="M4 12h16"/>
            <path d="M4 19h16"/>
        </svg>
    </button>
</th:block>
